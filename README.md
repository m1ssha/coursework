# SPHINCS+

Этот репозиторий содержит реализацию криптографической подписи SPHINCS+ с двумя интерфейсами: консольным (`main.py`) и графическим (`gui.py`). SPHINCS+ — это постквантовая схема подписи, устойчивая к атакам с использованием квантовых компьютеров.

## Описание

- **`main.py`**: Консольный интерфейс для генерации ключей, подписи сообщений/файлов и проверки подписи через командную строку с использованием флагов.
- **`gui.py`**: Графический интерфейс на основе `tkinter` для удобной работы с SPHINCS+ через окно приложения.
- **Папка `src`**: Содержит основные функции SPHINCS+ (`sphincs.py`, `parameters.py`, и т.д.), которые используются обоими интерфейсами.

## Установка

1. Склонируйте репозиторий:
   ```bash
   git clone https://github.com/m1ssha/sphincsplus.git
   cd sphincsplus
   ```

2. Убедитесь, что Python установлен:
   ```bash
   python --version
   ```

3. Установите зависимости (необходимы только для тестирования (`testing.py`))
   ```bash
   python -m venv venv
   venv/Scripts/activate
   pip install -r requirements.txt
   ```

## Использование

### `main.py` — Консольный интерфейс

Запускается через командную строку с использованием флагов. Поддерживает генерацию ключей, подпись и проверку.

#### Основные флаги
- `--instance`: Выбор набора параметров SPHINCS+ (`128s`, `128f`, `192s`, `192f`, `256s`, `256f`). По умолчанию: `256f`.
- `--gen-keys`: Сгенерировать пару ключей.
- `--sk-out <путь>`: Сохранить секретный ключ.
- `--pk-out <путь>`: Сохранить открытый ключ.
- `--sign <сообщение или файл>`: Подписать строку или файл.
- `--sk <путь>`: Путь к секретному ключу для подписи.
- `--sig-out <путь>`: Сохранить подпись.
- `--verify <сообщение или файл>`: Проверить строку или файл.
- `--pk <путь>`: Путь к открытому ключу для проверки.
- `--sig <путь>`: Путь к файлу подписи.
- `--from-file`: Указывает, что входные данные — это файл (хэшируется SHA-256).

#### Примеры

1. **Генерация ключей**:
   ```bash
   python main.py --instance 128f --gen-keys --sk-out secret.sk --pk-out public.pk
   ```

2. **Подпись строки**:
   ```bash
   python main.py --instance 128f --sign "Привет, SPHINCS+!" --sk secret.sk --sig-out message.sig
   ```

3. **Подпись файла**:
   ```bash
   python main.py --instance 128f --sign test.txt --sk secret.sk --sig-out test.sig --from-file
   ```

4. **Проверка строки**:
   ```bash
   python main.py --instance 128f --verify "Привет, SPHINCS+!" --pk public.pk --sig message.sig
   ```

5. **Проверка файла**:
   ```bash
   python main.py --instance 128f --verify test.txt --pk public.pk --sig test.sig --from-file
   ```

6. **Справка**:
   ```bash
   python main.py --help
   ```

#### Вывод
- При генерации ключей: отображает ключи в шестнадцатеричном виде и пути сохранения.
- При подписи: длина подписи, компоненты и путь сохранения.
- При проверке: результат (`Подпись верна` или `Подпись неверна`).

---

### `gui.py` — Графический интерфейс

Запускается как приложение с окном для интерактивной работы. Поддерживает те же функции, что и `main.py`, но через кнопки и текстовое поле.

#### Запуск
```bash
python gui.py
```

#### Интерфейс
- **Набор параметров**: Выпадающий список для выбора `128s`, `128f`, `192s`, `192f`, `256s`, `256f`.
- **Сгенерировать пару ключей**: Создаёт секретный и открытый ключи.
- **Выбрать файл**: Выбор файла для подписи или проверки.
- **Подписать файл (хэш)**: Подписывает хэш выбранного файла.
- **Проверить файл**: Проверяет подпись файла (требуется только открытый ключ).
- **Сохранить ключи**: Сохраняет ключи в файлы `.sk` и `.pk`.
- **Загрузить ключи**: Загружает ключи (секретный — опционально, открытый — обязателен для проверки).
- **Сохранить подпись**: Сохраняет подпись в файл `.sig`.
- **Загрузить подпись**: Загружает подпись и автоматически устанавливает нужный набор параметров.
- **Результат**: Текстовое поле с информацией о действиях и результатах.

#### Пример работы
1. **Генерация ключей**:
   - Выберите `128f`, нажмите "Сгенерировать пару ключей".
   - Нажмите "Сохранить ключи", выберите путь (например, `keys` → `keys.sk` и `keys.pk`).

2. **Подпись файла**:
   - Нажмите "Выбрать файл", выберите `test.txt`.
   - Нажмите "Загрузить ключи", выберите "Да" и загрузите `keys.sk`.
   - Нажмите "Подписать файл (хэш)".
   - Нажмите "Сохранить подпись", сохраните как `test.sig`.

3. **Проверка файла**:
   - Перезапустите GUI.
   - Нажмите "Загрузить подпись", выберите `test.sig` (параметры установятся автоматически).
   - Нажмите "Загрузить ключи", выберите "Нет" для секретного, затем загрузите `keys.pk`.
   - Нажмите "Выбрать файл", выберите `test.txt`.
   - Нажмите "Проверить файл" — результат отобразится в поле "Результат".

#### Особенности
- Все сообщения на русском языке.
- Автоматическая установка набора параметров при загрузке подписи.
- Для проверки достаточно только открытого ключа.

---

## Структура файлов

```
<sphincsplus>/
├── src/
│   ├── sphincs.py         # Основная логика SPHINCS+
│   ├── parameters.py      # Параметры SPHINCS+
│   └── ...                # Другие модули
├── main.py                # Консольный интерфейс
├── gui.py                 # Графический интерфейс
└── README.md              # Этот файл
```

## Примечания

- **Безопасность**: Не используйте сгенерированные ключи в реальных системах без проверки реализации на соответствие стандартам.
- **Производительность**: Подпись SPHINCS+ может занимать время для параметров вроде `256f`.